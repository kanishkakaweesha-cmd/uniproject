<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Login - Online Delivery Management</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }
      body{
        font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;
        padding:0;
        margin:0;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height:100vh;
        display:flex;
        align-items:center;
        justify-content:center;
        transition: background 0.3s ease;
      }
      body.dark-theme {
        background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
      }
      .theme-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        background: rgba(255, 255, 255, 0.2);
        border: 2px solid rgba(255, 255, 255, 0.3);
        color: #fff;
        padding: 0.75rem 1.25rem;
        border-radius: 30px;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 600;
        transition: all 0.3s;
        z-index: 1000;
        backdrop-filter: blur(10px);
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .theme-toggle:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: scale(1.05);
      }
      body.dark-theme .theme-toggle {
        background: rgba(30, 41, 59, 0.8);
        border-color: rgba(148, 163, 184, 0.3);
        color: #e2e8f0;
      }
      .container{width:100%;max-width:420px;padding:20px;margin:0 auto;}
      .card{
        background: rgba(255, 255, 255, 0.95);
        border-radius:12px;
        box-shadow:0 6px 24px rgba(8,20,40,0.08);
        padding:32px;
        transition: background 0.3s ease;
      }
      body.dark-theme .card {
        background: rgba(30, 41, 59, 0.95);
      }
      .brand{display:flex;align-items:center;justify-content:center;margin-bottom:12px}
      .logo img{height:50px;display:block;margin:0 auto;}
      h1 {
        margin:6px 0 12px;
        font-size:20px;
        color: #2d3748;
        transition: color 0.3s ease;
      }
      body.dark-theme h1 {
        color: #e2e8f0;
      }
      form{display:flex;flex-direction:column;gap:10px}
      label{
        display:block;
        font-size:14px;
        color:#666;
        transition: color 0.3s ease;
        margin-bottom: 16px;
      }
      body.dark-theme label {
        color: #94a3b8;
      }
      label span {
        display: block;
        margin-bottom: 6px;
        font-weight: 600;
      }
      input{
        padding:12px;
        border-radius:8px;
        border:1px solid #e6e9ee;
        background: #fff;
        color: #2d3748;
        transition: background 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        width: 100%;
        font-size: 14px;
      }
      body.dark-theme input {
        background: #1e293b;
        border-color: #475569;
        color: #e2e8f0;
      }
      input:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }
      body.dark-theme input:focus {
        border-color: #60a5fa;
        box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.1);
      }
      .actions{display:flex;gap:12px;align-items:center}
      .btn-primary{
        background:#3498db;
        color:#fff;
        padding:12px 20px;
        border-radius:8px;
        border:none;
        cursor:pointer;
        transition: all 0.2s;
        font-size:16px;
        font-weight:600;
      }
      .btn-primary:hover {transform: translateY(-2px); box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);}
      #msg {
        color:#333;
        transition: color 0.3s ease;
      }
      body.dark-theme #msg {
        color: #e2e8f0;
      }
      .register-btn {
        padding:8px 10px;
        border-radius:8px;
        border:1px solid #ddd;
        background: transparent;
        cursor: pointer;
        transition: all 0.2s;
      }
      body.dark-theme .register-btn {
        border-color: #475569;
        color: #e2e8f0;
      }
    </style>
  </head>
  <body>
    <button class="theme-toggle" onclick="toggleTheme()">
      <span id="theme-icon">ðŸŒ™</span>
      <span id="theme-text">Dark</span>
    </button>
    <div class="container">
      <div class="card">
        <div class="brand">
          <div class="logo" style="text-align: center; width: 100%;"><img src="/logo.svg" alt="Logo"></div>
        </div>
        <h1 style="margin:16px 0 20px;font-size:24px;text-align:center;">Login to E - Delivery</h1>
        <form id="loginForm">
          <label>
            <span>Email Address</span>
            <input name="email" type="email" placeholder="Enter your email" required>
          </label>
          <label>
            <span>Password</span>
            <input name="password" type="password" placeholder="Enter your password" required>
          </label>
          <div class="actions" style="flex-direction: column; align-items: stretch;">
            <button class="btn-primary" type="submit" style="width: 100%;">Login</button>
            <div id="msg" style="color:#333;text-align:center;margin-top:10px;"></div>
            <div style="text-align:center;margin-top:16px;">
              <span style="color:#666;">Don't have an account? </span>
              <a href="/auth/register" style="color:#3498db;text-decoration:none;font-weight:600;">Register here</a>
            </div>
          </div>
        </form>
      </div>
    </div>
    <script>
      // Theme toggle functionality
      function toggleTheme() {
        const body = document.body;
        const themeIcon = document.getElementById('theme-icon');
        const themeText = document.getElementById('theme-text');
        
        body.classList.toggle('dark-theme');
        
        if (body.classList.contains('dark-theme')) {
          themeIcon.textContent = 'â˜€ï¸';
          themeText.textContent = 'Light';
          localStorage.setItem('theme', 'dark');
        } else {
          themeIcon.textContent = 'ðŸŒ™';
          themeText.textContent = 'Dark';
          localStorage.setItem('theme', 'light');
        }
      }

      // Load saved theme preference
      (function() {
        const savedTheme = localStorage.getItem('theme');
        const themeIcon = document.getElementById('theme-icon');
        const themeText = document.getElementById('theme-text');
        
        if (savedTheme === 'dark') {
          document.body.classList.add('dark-theme');
          if (themeIcon) themeIcon.textContent = 'â˜€ï¸';
          if (themeText) themeText.textContent = 'Light';
        }
      })();

      // Login form handler
      document.getElementById('loginForm').addEventListener('submit', async function(e){
        e.preventDefault();
        var form = e.target;
        var data = Object.fromEntries(new FormData(form));
        var msg = document.getElementById('msg'); msg.textContent='';
        
        try{
          var res = await fetch('/auth/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});
          var body = await res.json().catch(()=>({}));
          if(!res.ok) throw body;
          msg.style.color='green'; msg.textContent='Logged in successfully. Redirecting...';
          setTimeout(()=>location.href='/dashboard',500);
        }catch(err){ msg.style.color='crimson'; msg.textContent = (err && err.error) ? err.error : JSON.stringify(err); }
      });
    </script>
  </body>
</html>
